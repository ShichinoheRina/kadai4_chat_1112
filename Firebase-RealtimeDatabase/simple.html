<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="utf-8">
    <title>Firebase_version9_RealtimeDB(G'sACADEMYåˆå­¦è€…ç”¨ã‚µãƒ³ãƒ—ãƒ«)</title>
    <link rel="stylesheet" href="style.css">
</head>

<header class="top">

</header>

<body>
    <div id="output"></div>
    <div>
        <button id="color">æ–‡å­—è‰²</button>
        <button id="bold">å¤ªå­—</button>
        <button id="sakujyo">å‰Šé™¤</button>
        <div> åå‰ï¼š<input type="text" id="uname"> </div>
        <div>
            <textarea  class="textnakami" id="text" cols="60" rows="10"></textarea>
            <button id="send" class="sendbtn">é€ä¿¡</button>
            
        </div>
    </div>

    

    <!-- JQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <!-- JQuery -->

    <!--** ä»¥ä¸‹Firebase **-->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.1.0/firebase-app.js";

        // è²¼ã‚Šä»˜ã‘ã‚‹å ´æ‰€
        import { getDatabase, ref, push, set, onChildAdded, remove, onChildRemoved } from "https://www.gstatic.com/firebasejs/9.1.0/firebase-database.js";
        // 


        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries

        // Your web app's Firebase configuration
        const firebaseConfig = {
  
};
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);

        // ã“ã®è¾ºã‚Šã«æ›¸ã„ã¦ã„ãã¾ã™


        const db = getDatabase(app);
        const dbRef = ref(db, 'dev245');

        var bold1 = "";
        var bold2 = "";       
        var color1= ""; 
        const name =$('#uname').val()
        $('#bold').on('click',function(){
             bold1 = "<b>";
             bold2 = "</b>"; 
        });
        $('#color').on('click',function(){
             color1 = " style='color:red'";
            //  color2 = "</b>"; 
        });
        $('#sakujyo').on('click',function(){
         
        });
        // é€ä¿¡å‡¦ç†ã‚’è¨˜è¿°
        $('#send').on('click', function () {

            // id="uname" ã®å ´æ‰€ã‚’å–å¾—ã—ã¾ã™ğŸ¤—
            const uname = "<p"+color1+">"+bold1+$('#uname').val()+bold2;
            // id="text" ã®å ´æ‰€ã‚’å–å¾—ã—ã¾ã™ğŸ¤—
            const text = bold1+$('#text').val()+bold2;
  
            bold1 ="";
            bold2 ="";
            color1="";
            // é€ä¿¡å¾Œãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã®ä¸­èº«ã‚’æ¶ˆã™
            $('textarea').val(""); 
            

            // ãƒ‡ãƒ¼ã‚¿ã®å¡Šã‚’ä½œã‚Šã¾ã™ğŸ¤—
            // msg ã¨ã„ã†åå‰ã§å¡Šã‚’ä½œã‚Šã¾ã™
            // ä½œæˆã—ãŸãƒ‡ãƒ¼ã‚¿ã®å¡Šã‚’firebaseã«é€ä¿¡ã‚’ã—ã¾ã™â‡¨ã¤ã¾ã‚Šã“ã‚ŒãŒä¿å­˜ã«ãªã‚Šã¾ã™ğŸ¤—
            const msg = {
                uname: uname,
                text: text,
            }
            
            // firebaseã«é€ã‚‹æº–å‚™ã‚’ã—ã¦ã„ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ğŸ¤—
            const newPostRef = push(dbRef) //ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã§ãã‚‹æº–å‚™
            set(newPostRef, msg); // firebaseã®ç™»éŒ²ã§ãã‚‹å ´æ‰€ã«ä¿å­˜ã™ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™ğŸ¤—
            
            // sendé€ä¿¡ã‚¤ãƒ™ãƒ³ãƒˆ ã“ã®ä¸‹æ¶ˆã•ãªã„
        });



        // å—ä¿¡å‡¦ç†ã‚’è¨˜è¿°
        onChildAdded(dbRef, function (data) {
            // ç™»éŒ²ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¾ã™ğŸ¤—
            const msg = data.val();
            console.log(msg, 'å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã®å¡Š')
            const key = data.key;
            console.log(key, 'ãƒ‡ãƒ¼ã‚¿ã®å¡Šã«ã‚¢ã‚¯ã‚»ã‚¹')


            // es6ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒªãƒ†ãƒ©ãƒ«
            let h = `
                <div class="msg">
                    ${msg.uname}:${msg.text}</p>
                </div>    
            `;
            // htmlã«åŸ‹ã‚è¾¼ã¿ã¾ã—ã‚‡ã†ğŸ¤—
            // append();ã¨ã„ã†jqueryã®ãŠã¾ã˜ãªã„ã‚’ä½¿ã„ã¾ã™
            $("#output").append(h);
        })

    // å…¥åŠ›ä¸­...ã®è¡¨ç¤º
    $(function(){

$('#text').keyup(function(){
  var count = $(this).val().length;
  if(count>0){
    console.log("æ–‡å­—ã¯ã„ã£ã¦ã¾ã™");
    $('.sendbtn').css({'background-color': '#d4c8f8'});
  }else{
    $('.sendbtn').css({'background-color': 'white'});
    setTimeout(function () {$(message).hide();}, 2000);
  }}
    )});

const message = "ã•ã‚“ãŒã‚¿ã‚¤ãƒ”ãƒ³ã‚°ä¸­ã§ã™"
setTimeout(function () {
    $("#output").append(message);
                            }, 1000);
aa

    </script>


<style>
    /* #output {
        background: pink;
        height: 300px;
        overflow: scroll;
    } */

    /* .msg:nth-child(odd) {
        width: 40%;
        background: gainsboro;
        margin-left: auto;
        border-radius: 10px;
        padding: 10px;
        box-sizing: border-box;
    }

    .msg:nth-child(even) {
        background: bisque;
        width: 40%;
        padding: 10px;
        border-radius: 10px;
    } */
</style>








</body>

</html>































